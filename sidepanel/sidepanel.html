<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pawz Sidepanel</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!-- HEADER -->
    <header class="w-header">
      <div class="brand-area">
        <img src="../assets/logo.svg" alt="Pawz" class="logo-icon" />
        <span class="brand-name">Pawz</span>
      </div>
      <div class="actions-area">
        <button id="btn-settings" class="icon-btn" title="Param√®tres">‚öôÔ∏è</button>
      </div>
    </header>

    <!-- NAVIGATION TABS -->
    <div class="nav-tabs">
      <div id="tab-search" class="nav-item active">Recherche</div>
      <div id="tab-analysis" class="nav-item">Analyse</div>
    </div>

    <!-- BODY -->
    <div class="w-body">

      <!-- ============================================ -->
      <!-- VUE ONGLET : RECHERCHE (Gestion des Mandats) -->
      <!-- ============================================ -->
      <div id="view-search">

        <!-- SOUS-VUE 1 : LISTE DES JOBS -->
        <div id="jobs-list-view">
            <div class="jobs-list-header">
                <h3>Mes recherches</h3>
                <button id="btn-create-job" class="btn-create">+ Nouvelle</button>
            </div>
            <div id="jobs-container" class="jobs-scroll-area">
                <!-- Inject√© par JS -->
            </div>
        </div>

        <!-- SOUS-VUE 2 : √âDITION JOB -->
        <div id="job-edit-view" class="hidden">
            <div class="edit-nav">
                <button id="btn-back-jobs" class="back-link">‚Üê Retour</button>
            </div>

            <!-- BLOC FORMULAIRE -->
            <div id="job-form-section">
                <div class="input-group">
                    <input type="text" id="job-title-input" class="job-title-input" placeholder="Titre du poste...">
                </div>
                <div class="input-group">
                  <div class="label-row">
                    <label class="input-label">üìù Fiche de Poste</label>
                    <div class="label-tools">
                        <button id="btn-undo-form" class="mini-btn" title="R√©tablir la version enregistr√©e">‚Ü©</button>
                        <button id="btn-clear-form" class="mini-btn" title="Vider le contenu">üîÑ</button>
                    </div>
                  </div>
                  <textarea id="brief-text" class="styled-textarea" placeholder="Collez la description du poste ici..."></textarea>
                </div>
                <div class="input-group">
                  <label class="input-label" style="color: #F97316;">‚õî Crit√®res Obligatoires</label>
                  <div class="skill-adder">
                    <input id="must-input" type="text" class="skill-input" placeholder="Ajouter...">
                    <button id="btn-add-must" class="add-btn">+</button>
                  </div>
                  <div id="must-tags" class="skill-tags"></div>
                </div>
                <div class="input-group">
                  <label class="input-label" style="color: #10b981;">‚ú® Les Plus</label>
                  <div class="skill-adder">
                    <input id="nice-input" type="text" class="skill-input" placeholder="Ajouter...">
                    <button id="btn-add-nice" class="add-btn">+</button>
                  </div>
                  <div id="nice-tags" class="skill-tags"></div>
                </div>
                <div class="save-container">
                  <button id="btn-save-search" class="btn-main primary">Enregistrer</button>
                </div>
            </div>

            <!-- SECTIONS ADDITIONNELLES (√âdition seulement) -->
            <div id="job-extra-sections" class="hidden">
                
                <!-- BLOC COMPRENDRE LE BESOIN -->
                <div class="section-divider"></div>
                <div id="understand-block" class="understand-card">
                    <div class="understand-header">
                        <span class="understand-icon">üß†</span>
                        <span class="understand-title">Comprendre le besoin</span>
                    </div>
                    <!-- √âtat 1: Pas encore analys√© -->
                    <div id="understand-empty" class="understand-cta">
                        <p>L'IA peut analyser votre fiche de poste pour mieux scorer les candidats.</p>
                        <button id="btn-understand" class="btn-understand">Analyser ma fiche de poste</button>
                    </div>
                    <!-- √âtat 2: Analyse disponible (Accordion) -->
                    <div id="understand-result" class="understand-result hidden">
                        <div class="accordion open">
                            <div class="accordion-header">
                                <span>üìã R√©sum√© de l'analyse</span>
                                <div class="header-chevron">‚ñº</div>
                            </div>
                            <div class="accordion-content">
                                <p id="understand-summary">Analyse g√©n√©r√©e par l'IA...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- BLOC ANALYSES ASSOCI√âES -->
                <div class="section-divider"></div>
                <div id="job-candidates-section">
                    <h4 class="section-title">Analyses associ√©es</h4>
                    <div id="job-candidates-list" class="candidates-container mini">
                        <!-- Inject√© par JS -->
                    </div>
                </div>

            </div>
        </div>
      </div>

      <!-- ============================================ -->
      <!-- VUE ONGLET : ANALYSE (Liste Candidats)       -->
      <!-- ============================================ -->
      <div id="view-analysis" class="hidden">
        <div id="active-job-banner" class="active-job-banner hidden">
            <span>üî¥ Job actif : <b id="banner-job-title">Aucun</b></span>
        </div>
        <div class="queue-stats">
          <span class="stat-badge">‚è≥ <span id="count-pending">0</span></span>
          <span class="stat-badge">‚úÖ <span id="count-done">0</span></span>
        </div>
        <div id="candidates-list" class="candidates-container">
          <div class="empty-state"><p>Aucun candidat.</p></div>
        </div>
      </div>

    </div>

    <!-- DETAIL OVERLAY (Candidat) -->
    <div id="detail-overlay" class="detail-panel hidden">
      <div class="detail-nav">
        <button id="btn-close-detail" class="back-btn">‚Üê Retour</button>
        <div class="nav-arrows">
            <button id="btn-prev-candidate" class="nav-arrow-btn">‚¨Ü</button>
            <button id="btn-next-candidate" class="nav-arrow-btn">‚¨á</button>
        </div>
      </div>
      <div class="analysis-content">
        <div class="score-header">
          <h1 id="detail-score" class="score-display">--%</h1>
          <span id="detail-verdict" class="verdict-badge">En attente</span>
        </div>
        <h2 id="detail-name" class="candidate-name-detail">Nom</h2>
        <p id="detail-title" class="candidate-title-detail">Titre</p>
        <div class="accordion open">
          <div class="accordion-header"><span>‚úÖ Points Forts</span><div class="header-chevron">‚ñº</div></div>
          <div class="accordion-content"><ul id="detail-strengths" class="list-check"></ul></div>
        </div>
        <div class="accordion">
          <div class="accordion-header"><span>‚ö†Ô∏è Vigilance</span><div class="header-chevron">‚ñº</div></div>
          <div class="accordion-content"><ul id="detail-warnings" class="list-warn"></ul></div>
        </div>
        <div class="accordion">
          <div class="accordion-header"><span>ü§ñ R√©sum√©</span><div class="header-chevron">‚ñº</div></div>
          <div class="accordion-content"><p id="detail-summary"></p></div>
        </div>
      </div>
      <div class="detail-footer">
        <a id="btn-open-linkedin" href="#" target="_blank" class="btn-secondary">Voir Profil</a>
        <button id="btn-delete-current" class="btn-danger">Rejeter</button>
      </div>
    </div>

    <!-- SETTINGS OVERLAY -->
    <div id="settings-overlay" class="settings-overlay hidden">
      <div class="w-header">
        <div class="brand-area">
          <button id="btn-back-settings" class="icon-btn">‚Üê</button>
          <span class="brand-name">Param√®tres</span>
        </div>
        <div class="actions-area"><button id="btn-close-settings" class="icon-btn">√ó</button></div>
      </div>
      <div class="w-body">
        <p class="settings-header-text">Gestion de la cl√© API Gemini.</p>
        <div class="provider-card active-provider open">
          <div class="provider-header">
            <div class="header-left"><span class="provider-name">Google Gemini</span></div>
            <div class="header-right"><span id="api-status" class="status-badge">Check</span></div>
          </div>
          <div class="api-config-area" style="display: block">
            <div class="api-input-group">
              <label class="api-label">Cl√© API</label>
              <div class="api-input-wrapper">
                <input id="api-key-input" type="text" class="api-input" placeholder="AIza..." autocomplete="off"/>
                <button id="btn-save-api" class="btn-validate">Valider</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="sidepanel.js"></script>
  </body>
</html>
